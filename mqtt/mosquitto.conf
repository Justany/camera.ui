# ===================================
# Configuration Mosquitto MQTT Broker
# ===================================

# Port par défaut MQTT
listener 1883
protocol mqtt

# WebSocket (optionnel pour l'interface web)
listener 9001
protocol websockets

# Autoriser les connexions anonymes (à désactiver en production)
allow_anonymous true

# Fichiers de log
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# Timestamp dans les logs
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Persistence des messages
persistence true
persistence_location /mosquitto/data/

# Fichier de persistence
persistence_file mosquitto.db

# Sauvegarder automatiquement toutes les 30 minutes
autosave_interval 1800

# Paramètres de connexion
max_connections -1
max_queued_messages 1000

# Qualité de service maximale
max_qos 2

# Keepalive
keepalive_interval 60

# ===================================
# Sécurité (Décommenter pour activer)
# ===================================

# Utiliser un fichier de mot de passe
# password_file /mosquitto/config/passwd

# Utiliser un fichier ACL (Access Control List)
# acl_file /mosquitto/config/acl

# Activer TLS/SSL (nécessite des certificats)
# listener 8883
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key
# require_certificate false
# tls_version tlsv1.2

# ===================================
# Topics système
# ===================================
sys_interval 10

# Désactiver les messages système anonymes
# sys_messages false

